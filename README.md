Introduction
------------

Writing unit tests for SQL queries in a Java application stack is not easy. One of the challenges is setting up the test data on which the the query will run. 

To keep tests comprehensive and maintainable we have the following requirements for such data:

* **Data should be defined per test**. We think it is not maintainable to have a single dump, which is used for all tests. Each test ensures that a certain aspect of the query is implemented correctly. We doubt that it is possible to set up a single dump which contains all possible test cases. We doubt even more that such a dump stays maintainable in the long run.
* **Data should be defined close to the test**. The closer the data is to the test, the more likely is, that it stays maintainable. The closest the data can be to test is actually in the test. Hence test data has to be set up in same language the test is written in.
* **Data setup should only describe the aspects that matter** and therefore should be free of redundancy. Since relational database tables tend to contain a lot of repetitive data, setting up this data is poses a challenge if such tests should stay mantainable.

Daleq is a DSL to define the content of a relational database in a concise and neat manner. It is actually very simple. 

Let's assume you have such a database

```sql
CREATE TABLE PRODUCT (
  ID    INT  GENERATED BY DEFAULT AS SEQUENCE PRODUCT_SEQ,
  NAME  VARCHAR(250) NOT NULL,
  SIZE  VARCHAR(250) NOT NULL,
  PRICE DECIMAL(10,2) NOT NULL,
  PRIMARY KEY (ID)
);
```
then you will have to model this table in Java as well. Simply write
```java
@TableDef("PRODUCT")
public class ProductTable {
    public static final FieldDef ID = Daleq.fd(DataType.INTEGER);
    public static final FieldDef NAME = Daleq.fd(DataType.VARCHAR);
    public static final FieldDef SIZE = Daleq.fd(DataType.VARCHAR);
    public static final FieldDef PRICE = Daleq.fd(DataType.DECIMAL);
}
```
and Daleq is ready to be used. Now let's have a look at Daleq DSL. It is even more simple. It consists of two concepts: First there is a Table
```java
final Table table = Daleq.aTable(ProductTable.class);
```
Examples
--------

For now have a look at the [tests in the example code](https://github.com/brands4friends/daleq/blob/master/examples/src/test/java/de/brands4friends/daleq/examples/JdbcProductDaoTest.java).

Authors
-------

**Lars Girndt**

Copyright and license
---------------------

Copyright 2012 brands4friends, Private Sale GmbH

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this work except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
